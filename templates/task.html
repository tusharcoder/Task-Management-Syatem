{%extends 'base.html'%}
{%block content%}

<style>

.body-wrap {
  min-height: 700px;
}

.body-wrap {
  position: relative;
  z-index: 0;
}

.body-wrap:before,
.body-wrap:after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  z-index: -1;
  height: 260px;
}

.body-wrap:after {
  top: auto;
  bottom: 0;
}

</style>

<nav class="navbar navbar-inverse" role="navigation">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Scaledesk</a>
    </div>

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/">Home</a></li>
        <li><a href="/about/">About</a></li>
        <li class="active"><a href="/task/">Tasks</a></li>
        <li><a href="/viewtasks/">View Tasks</a></li>
        <li><a href="/profile">Profile</a></li>
        {% if staff %}
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dashboard <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="/userstask/">Daily tasks of all user</a></li>
            <li class="divider"></li>
            <li><a href="/userslist/">List of Users</a></li>
            <li class="divider"></li>
            <li><a href="/approvedtasks/">Approved Tasks</a></li>
            <li class="divider"></li>
            <li><a href="/pendingtasks/">Pending Tasks</a></li>
            <li class="divider"></li>
            <li><a href="/rejectedtasks/">Rejected Tasks</a></li>
            <li class="divider"></li>
            <li><a href="/projectreport/">Project Report</a></li>
            <li class="divider"></li>
            <li><a href="/worktypereport/">WorkType Report</a></li>
            <li class="divider"></li>
            <li><a href="/totalprojecthours/">Toal Project Hours</a></li>
            <li class="divider"></li>
            <li><a href="/userreport/">User Report</a></li>
          </ul>
        </li>
        {% endif %}
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#"><span class="glyphicon glyphicon-user"></span>{{user}}</a></li>
        <li><a href="{% url 'logout' %}"><span class="glyphicon glyphicon-log-out"></span> Log Out</a></li>
      </ul>
    </div>
  </div>
</nav>

<h2>Add <small>Tasks</small></h2>

<div class="container">
  <form class="" action="task.html" method="post">
    {% csrf_token %}
    <div class="form-group">
      <label for="name">Name:</label>
      <input type="text" name="name" class="form-control" id="name" placeholder="Enter the task name" value="{{task.name}}">

    </div>

    <div class="form-group">
      <label for="description">Description:</label>
      <input type="text" name="description" class="form-control" id="description" placeholder="Enter the task description" value="{{task.description}}">

    </div>

    <div class="form-group">
      <label for="starttime">Start Time:(In 24-hour format)</label>
      <input type="time" name="starttime" class="form-control" id="starttime" placeholder="Enter the start time of task" value="{{task.starttime}}">

    </div>

    <div class="form-group">
      <label for="endtime">End Time:(In 24-hour format)</label>
      <input type="time" name="endtime" class="form-control" id="endtime" onchange="calculate_duration()" placeholder="Enter the end time of task" value="{{task.endtime}}">

    </div>

    <div class="form-group">
      <label for="duration">Duration:</label>
      <input type="number" class="form-control" name="duration" id="diff" readonly>

    </div>

    <div class="form-group">
      <label for="project">Select Project:</label>
      <select class="form-control" id="project" name="project">
        <option value="">select project</option>
        {% for project in projects %}
        <option value="{{project.id}}">{{project.name}}</option>
        {% endfor %}
      </select>

    </div>

    <div class="form-group">
      <label for="worktype">Select Work Type:</label>
      <select class="form-control" id="worktype" name="worktype">
        <option value="">select worktype</option>
        {% for work in worktype %}
        <option value="{{work.id}}">{{work.name}}</option>
        {% endfor %}
      </select>

    </div>

    <div class="form-group">
      <label for="assigned_by">Assigned By:</label>
      <select class="form-control" id="assigned_by" name="assigned_by">
        <option value="">task assigned by</option>
        {% for assign in assigned_by %}
        <option value="{{assign.id}}">{{assign.username}}</option>
        {% endfor %}
      </select>

    </div>


  </div>


    <button type="submit" name="Add Task" class="btn btn-primary">Add Task</button>

    </form>
    </div>

    <script>
    $('ul.nav li.dropdown').hover(function() {
      $(this).find('.dropdown-menu').stop(true, true).delay(200).fadeIn(500);
    }, function() {
      $(this).find('.dropdown-menu').stop(true, true).delay(200).fadeOut(500);
    });
    </script>

    <script>

    function calculate_duration() {
      var start = document.getElementById("starttime").value;
      var end = document.getElementById("endtime").value;
      start = start.split(":");
      end = end.split(":");
      var startDate = new Date(0, 0, 0, start[0], start[1], 0);
      var endDate = new Date(0, 0, 0, end[0], end[1], 0);
      var diff = endDate.getTime() - startDate.getTime();
      var hours = Math.floor(diff / 1000 / 60 / 60);
      diff -= hours * 1000 * 60 * 60;
      var minutes = Math.floor(diff / 1000 / 60);
      document.getElementById("diff").setAttribute('value',hours*60+minutes)
    }

    </script>

{%endblock%}
